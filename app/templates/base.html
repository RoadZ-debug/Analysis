<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>{{ title }} - {{ system_settings.app_name }}</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="stylesheet" href="{{ url_for('static', filename='layui-v2.2.5/layui/css/layui.css') }}"  media="all">
  <style>
    body { padding-top: 60px; }
    .layui-layout-admin .layui-header { position: fixed; top: 0; left: 0; right: 0; }
    .container { padding: 20px; }
    .layui-body-full { left: 0 !important; }
  </style>
</head>
<body class="layui-layout-body">
<div class="layui-layout layui-layout-admin">
  
  {% if current_user.is_authenticated %}
  <div class="layui-header">
    <div class="layui-logo">{{ system_settings.app_name[:10] }}...</div>
    <!-- 头部区域（可配合layui已有的水平导航） -->
    <ul class="layui-nav layui-layout-right">
      <li class="layui-nav-item">
        <a href="javascript:;">
          {{ current_user.username }}
        </a>
      </li>
      <li class="layui-nav-item"><a href="{{ url_for('logout') }}">退了</a></li>
    </ul>
  </div>

  <div class="layui-side layui-bg-black">
    <div class="layui-side-scroll">
      <!-- 左侧导航区域（可配合layui已有的垂直导航） -->
      <ul class="layui-nav layui-nav-tree"  lay-filter="test">
        <li class="layui-nav-item layui-nav-itemed">
          <a class="" href="javascript:;">系统功能</a>
          <dl class="layui-nav-child">
            <dd><a href="{{ url_for('index') }}">控制台</a></dd>
            {% if current_user.role == 'admin' %}
            <dd><a href="{{ url_for('admin') }}">后台管理</a></dd>
            <dd><a href="{{ url_for('admin_collection') }}">数据采集管理</a></dd>
            <dd><a href="{{ url_for('admin_data_warehouse') }}">数据仓库管理</a></dd>
            <dd><a href="{{ url_for('admin_rules') }}">采集规则库</a></dd>
            <dd><a href="{{ url_for('admin_ai_engines') }}">AI引擎管理</a></dd>
            <dd><a href="{{ url_for('admin_ai_analysis') }}">AI数据清洗分析</a></dd>
            {% endif %}
          </dl>
        </li>
      </ul>
    </div>
  </div>
  {% endif %}

  <div class="layui-body {{ 'layui-body-full' if not current_user.is_authenticated else '' }}">
    <!-- 内容主体区域 -->
    <div style="padding: 15px;">
      {% with messages = get_flashed_messages() %}
      {% if messages %}
        {% for message in messages %}
          <div class="layui-alert layui-bg-red" style="margin-bottom: 10px; padding: 10px;">{{ message }}</div>
        {% endfor %}
      {% endif %}
      {% endwith %}
      
      {% block content %}{% endblock %}
    </div>
  </div>
  
  {% if current_user.is_authenticated %}
  <div class="layui-footer" style="left: 0; text-align: center;">
    <!-- 底部固定区域 -->
    © layui.com - {{ system_settings.app_name }}
  </div>
  {% endif %}
</div>
<script src="{{ url_for('static', filename='layui-v2.2.5/layui/layui.js') }}" charset="utf-8"></script>
<script>
layui.use(['element', 'layer'], function(){
  var element = layui.element;
  var layer = layui.layer;
});
</script>
{% block scripts %}{% endblock %}
</body>
</html>
